<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:controls="clr-namespace:DicomViewer.UI.Controls">

    <!-- 슬라이스 네비게이터 브러시 / Slice navigator brushes -->
    <SolidColorBrush x:Key="NavigatorBackgroundBrush" Color="#1E1E1E" />
    <SolidColorBrush x:Key="NavigatorBorderBrush" Color="#3E3E3E" />
    <SolidColorBrush x:Key="ThumbnailSelectedBrush" Color="#0078D7" />
    <SolidColorBrush x:Key="ThumbnailHoverBrush" Color="#404040" />
    <SolidColorBrush x:Key="SliderTrackBrush" Color="#505050" />
    <SolidColorBrush x:Key="SliderThumbBrush" Color="#0078D7" />

    <!-- 썸네일 아이템 스타일 / Thumbnail item style -->
    <Style x:Key="ThumbnailListBoxItemStyle" TargetType="{x:Type ListBoxItem}">
        <Setter Property="Padding" Value="2" />
        <Setter Property="Margin" Value="2" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderThickness" Value="2" />
        <Setter Property="BorderBrush" Value="Transparent" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ListBoxItem}">
                    <Border x:Name="Bd"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Padding="{TemplateBinding Padding}"
                            CornerRadius="2">
                        <Grid>
                            <!-- 썸네일 이미지 / Thumbnail image -->
                            <Image Source="{Binding ImageSource}"
                                   Stretch="Uniform"
                                   RenderOptions.BitmapScalingMode="NearestNeighbor" />

                            <!-- 슬라이스 번호 표시 / Slice number display -->
                            <Border Background="#80000000"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Bottom"
                                    Padding="2"
                                    CornerRadius="2"
                                    Margin="2">
                                <TextBlock Text="{Binding DisplayNumber}"
                                           Foreground="White"
                                           FontSize="10"
                                           FontFamily="Segoe UI" />
                            </Border>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="Bd" Property="Background" Value="{StaticResource ThumbnailHoverBrush}" />
                        </Trigger>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter TargetName="Bd" Property="BorderBrush" Value="{StaticResource ThumbnailSelectedBrush}" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- SliceNavigator 스타일 / SliceNavigator style -->
    <Style TargetType="{x:Type controls:SliceNavigator}">
        <Setter Property="Background" Value="{StaticResource NavigatorBackgroundBrush}" />
        <Setter Property="BorderBrush" Value="{StaticResource NavigatorBorderBrush}" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="MinWidth" Value="80" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:SliceNavigator}">
                    <Border Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <!-- 상단: 현재 슬라이스 정보 / Top: Current slice info -->
                            <Border Grid.Row="0"
                                    Background="#252525"
                                    Padding="8,4">
                                <TextBlock Foreground="White"
                                           FontFamily="Segoe UI"
                                           FontSize="12"
                                           HorizontalAlignment="Center">
                                    <Run Text="{Binding SelectedIndex, RelativeSource={RelativeSource TemplatedParent}, Converter={x:Static controls:SliceNavigator.IndexToDisplayConverter}}" />
                                    <Run Text=" / " />
                                    <Run Text="{Binding TotalCount, RelativeSource={RelativeSource TemplatedParent}}" />
                                </TextBlock>
                            </Border>

                            <!-- 중앙: 썸네일 목록 (가상화 적용) / Center: Thumbnail list (virtualized) -->
                            <ListBox x:Name="PART_ThumbnailList"
                                     Grid.Row="1"
                                     ItemsSource="{TemplateBinding Thumbnails}"
                                     SelectedIndex="{Binding SelectedIndex, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay}"
                                     ItemContainerStyle="{StaticResource ThumbnailListBoxItemStyle}"
                                     Background="Transparent"
                                     BorderThickness="0"
                                     ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                     ScrollViewer.VerticalScrollBarVisibility="Auto"
                                     VirtualizingPanel.IsVirtualizing="True"
                                     VirtualizingPanel.VirtualizationMode="Recycling"
                                     Visibility="{Binding ShowThumbnails, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource BoolToVisConverter}}">
                                <ListBox.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel Orientation="Horizontal" />
                                    </ItemsPanelTemplate>
                                </ListBox.ItemsPanel>
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Grid Width="{Binding ThumbnailSize, RelativeSource={RelativeSource AncestorType=controls:SliceNavigator}}"
                                              Height="{Binding ThumbnailSize, RelativeSource={RelativeSource AncestorType=controls:SliceNavigator}}">
                                            <Image Source="{Binding ImageSource}"
                                                   Stretch="Uniform"
                                                   RenderOptions.BitmapScalingMode="NearestNeighbor" />
                                            <Border Background="#80000000"
                                                    HorizontalAlignment="Right"
                                                    VerticalAlignment="Bottom"
                                                    Padding="2"
                                                    CornerRadius="2"
                                                    Margin="2">
                                                <TextBlock Text="{Binding DisplayNumber}"
                                                           Foreground="White"
                                                           FontSize="10"
                                                           FontFamily="Segoe UI" />
                                            </Border>
                                        </Grid>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>

                            <!-- 하단: 슬라이더 / Bottom: Slider -->
                            <Slider x:Name="PART_Slider"
                                    Grid.Row="2"
                                    Minimum="0"
                                    Maximum="{Binding TotalCount, RelativeSource={RelativeSource TemplatedParent}, Converter={x:Static controls:SliceNavigator.CountToMaxConverter}}"
                                    Value="{Binding SelectedIndex, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay}"
                                    Margin="8"
                                    Visibility="{Binding ShowSlider, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource BoolToVisConverter}}" />
                        </Grid>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Bool to Visibility 변환기 / Bool to Visibility converter -->
    <BooleanToVisibilityConverter x:Key="BoolToVisConverter" />

</ResourceDictionary>
